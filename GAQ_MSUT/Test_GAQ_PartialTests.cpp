#include "CppUnitTest.h"
#include "GAQ.h"
#include <numbers>

using namespace Microsoft::VisualStudio::CppUnitTestFramework;

namespace GAQ_MSUT
{
	TEST_CLASS(GAQ_Partial)
	{
	public:

		TEST_METHOD(Test_ToNumeric)
		{
			GAQ::GenerateGeneratingBlades();

			GAQ a = 2 * e1 * e2 + 3 * e1 * e2 * e3;
			GAQ b = -7 * one + 2 * e1 * e2 + 3 * e1 * e2 * e3;
			GAQ c;

			Assert::IsTrue(a.ToNumeric() == 1.0);
			Assert::IsTrue(b.ToNumeric() == - 7.0);
			Assert::IsTrue(c.ToNumeric() == 0.0);
		}

		TEST_METHOD(Test_RotorExponential)
		{
			GAQ::GenerateGeneratingBlades();

			GAQ rotorXY = rxy.RotorExponential(20, std::numbers::pi / 4);

			GAQ expected =
				0.39429 * one
				+ 0.16332 * (e1 * e2)
				- 0.16332 * (e1 * e2 * e11 * e13)
				+ 0.06765 * (e1 * e2 * e11 * e13 * e14 * e15)
				- 0.04083 * (e1 * e2 * e12 * e13)
				+ 0.016912 * (e1 * e2 * e12 * e13 * e14 * e15)
				- 0.06765 * (e1 * e2 * e14 * e15)
				+ 0.04083 * (e1 * e2 * e5 * e6 * e7 * e13)
				- 0.016912 * (e1 * e2 * e5 * e6 * e7 * e13 * e14 * e15)
				+ 0.016912 * (e1 * e2 * e5 * e6 * e7 * e8 * e9 * e13)
				- 0.007005 * (e1 * e2 * e5 * e6 * e7 * e8 * e9 * e13 * e14 * e15)
				+ 0.16332 * (e1 * e2 * e5 * e7)
				- 0.16332 * (e1 * e2 * e5 * e7 * e11 * e13)
				+ 0.06765 * (e1 * e2 * e5 * e7 * e11 * e13 * e14 * e15)
				- 0.04083 * (e1 * e2 * e5 * e7 * e12 * e13)
				+ 0.016912 * (e1 * e2 * e5 * e7 * e12 * e13 * e14 * e15)
				- 0.06765 * (e1 * e2 * e5 * e7 * e14 * e15)
				+ 0.06765 * (e1 * e2 * e5 * e7 * e8 * e9)
				- 0.06765 * (e1 * e2 * e5 * e7 * e8 * e9 * e11 * e13)
				+ 0.028021 * (e1 * e2 * e5 * e7 * e8 * e9 * e11 * e13 * e14 * e15)
				- 0.016912 * (e1 * e2 * e5 * e7 * e8 * e9 * e12 * e13)
				+ 0.007005 * (e1 * e2 * e5 * e7 * e8 * e9 * e12 * e13 * e14 * e15)
				- 0.028021 * (e1 * e2 * e5 * e7 * e8 * e9 * e14 * e15)
				- 0.04083 * (e1 * e2 * e6 * e13)
				+ 0.016912 * (e1 * e2 * e6 * e13 * e14 * e15)
				+ 0.04083 * (e1 * e2 * e6 * e7)
				- 0.04083 * (e1 * e2 * e6 * e7 * e11 * e13)
				+ 0.016912 * (e1 * e2 * e6 * e7 * e11 * e13 * e14 * e15)
				- 0.016912 * (e1 * e2 * e6 * e7 * e14 * e15)
				+ 0.016912 * (e1 * e2 * e6 * e7 * e8 * e9)
				- 0.016912 * (e1 * e2 * e6 * e7 * e8 * e9 * e11 * e13)
				+ 0.007005 * (e1 * e2 * e6 * e7 * e8 * e9 * e11 * e13 * e14 * e15)
				- 0.007005 * (e1 * e2 * e6 * e7 * e8 * e9 * e14 * e15)
				- 0.016912 * (e1 * e2 * e6 * e8 * e9 * e13)
				+ 0.007005 * (e1 * e2 * e6 * e8 * e9 * e13 * e14 * e15)
				- 0.04083 * (e1 * e2 * e7 * e11 * e12 * e13)
				+ 0.016912 * (e1 * e2 * e7 * e11 * e12 * e13 * e14 * e15)
				- 0.04083 * (e1 * e2 * e7 * e12)
				+ 0.016912 * (e1 * e2 * e7 * e12 * e14 * e15)
				- 0.016912 * (e1 * e2 * e7 * e8 * e9 * e11 * e12 * e13)
				+ 0.007005 * (e1 * e2 * e7 * e8 * e9 * e11 * e12 * e13 * e14 * e15)
				- 0.016912 * (e1 * e2 * e7 * e8 * e9 * e12)
				+ 0.007005 * (e1 * e2 * e7 * e8 * e9 * e12 * e14 * e15)
				+ 0.06765 * (e1 * e2 * e8 * e9)
				- 0.06765 * (e1 * e2 * e8 * e9 * e11 * e13)
				+ 0.028021 * (e1 * e2 * e8 * e9 * e11 * e13 * e14 * e15)
				- 0.016912 * (e1 * e2 * e8 * e9 * e12 * e13)
				+ 0.007005 * (e1 * e2 * e8 * e9 * e12 * e13 * e14 * e15)
				- 0.028021 * (e1 * e2 * e8 * e9 * e14 * e15)
				- 0.39429 * (e11 * e13)
				+ 0.16332 * (e11 * e13 * e14 * e15)
				- 0.098573 * (e12 * e13)
				+ 0.04083 * (e12 * e13 * e14 * e15)
				- 0.16332 * (e14 * e15)
				+ 0.098573 * (e5 * e6 * e7 * e13)
				- 0.04083 * (e5 * e6 * e7 * e13 * e14 * e15)
				+ 0.04083 * (e5 * e6 * e7 * e8 * e9 * e13)
				- 0.016912 * (e5 * e6 * e7 * e8 * e9 * e13 * e14 * e15)
				+ 0.39429 * (e5 * e7)
				- 0.39429 * (e5 * e7 * e11 * e13)
				+ 0.16332 * (e5 * e7 * e11 * e13 * e14 * e15)
				- 0.098573 * (e5 * e7 * e12 * e13)
				+ 0.04083 * (e5 * e7 * e12 * e13 * e14 * e15)
				- 0.16332 * (e5 * e7 * e14 * e15)
				+ 0.16332 * (e5 * e7 * e8 * e9)
				- 0.16332 * (e5 * e7 * e8 * e9 * e11 * e13)
				+ 0.06765 * (e5 * e7 * e8 * e9 * e11 * e13 * e14 * e15)
				- 0.04083 * (e5 * e7 * e8 * e9 * e12 * e13)
				+ 0.016912 * (e5 * e7 * e8 * e9 * e12 * e13 * e14 * e15)
				- 0.06765 * (e5 * e7 * e8 * e9 * e14 * e15)
				- 0.098573 * (e6 * e13)
				+ 0.04083 * (e6 * e13 * e14 * e15)
				+ 0.098573 * (e6 * e7)
				- 0.098573 * (e6 * e7 * e11 * e13)
				+ 0.04083 * (e6 * e7 * e11 * e13 * e14 * e15)
				- 0.04083 * (e6 * e7 * e14 * e15)
				+ 0.04083 * (e6 * e7 * e8 * e9)
				- 0.04083 * (e6 * e7 * e8 * e9 * e11 * e13)
				+ 0.016912 * (e6 * e7 * e8 * e9 * e11 * e13 * e14 * e15)
				- 0.016912 * (e6 * e7 * e8 * e9 * e14 * e15)
				- 0.04083 * (e6 * e8 * e9 * e13)
				+ 0.016912 * (e6 * e8 * e9 * e13 * e14 * e15)
				- 0.098573 * (e7 * e11 * e12 * e13)
				+ 0.04083 * (e7 * e11 * e12 * e13 * e14 * e15)
				- 0.098573 * (e7 * e12)
				+ 0.04083 * (e7 * e12 * e14 * e15)
				- 0.04083 * (e7 * e8 * e9 * e11 * e12 * e13)
				+ 0.016912 * (e7 * e8 * e9 * e11 * e12 * e13 * e14 * e15)
				- 0.04083 * (e7 * e8 * e9 * e12)
				+ 0.016912 * (e7 * e8 * e9 * e12 * e14 * e15)
				+ 0.16332 * (e8 * e9)
				- 0.16332 * (e8 * e9 * e11 * e13)
				+ 0.06765 * (e8 * e9 * e11 * e13 * e14 * e15)
				- 0.04083 * (e8 * e9 * e12 * e13)
				+ 0.016912 * (e8 * e9 * e12 * e13 * e14 * e15)
				- 0.06765 * (e8 * e9 * e14 * e15);
			Assert::IsTrue(rotorXY == expected);
		}
	};
}
